{% extends 'myschool_app/app/base.html' %}
{% load crispy_forms_tags %}
{% load i18n %}

{% block title %}
  {% trans 'Adicionar Evento' %}
{% endblock title %}

{% block content %}
<div class="d-flex">
  {% include 'myschool_app/app/partials/_sidebar.html' %}

  <div class="content p-4">
    <h2>{% trans 'Eventos' %}</h2>

    <div class="row mt-4">
      <div class="col">
        <form method="POST">
          {% csrf_token %}
          <div class="form-row">
            <div class="form-group col">
              {{ form.titulo|as_crispy_field }}
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              {{ form.data_inicio|as_crispy_field }}
            </div>
            <div class="form-group col-md-6">
              {{ form.data_fim|as_crispy_field }}
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col">
              {{ form.descricao|as_crispy_field }}
            </div>
          </div>
          <a href="{% url 'app-eventos-lista' %}" class="btn btn-dark">{% trans 'Voltar' %}</a>
          <input type="submit" class="btn btn-info" value="{% trans 'Guardar' %}">
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock content %}

{% block scripts %}
  <script>
    $('#id_data_inicio').datepicker({
      format: 'dd/mm/yyyy',
      language: 'pt'
    });
    $('#id_data_fim').datepicker({
      format: 'dd/mm/yyyy',
      language: 'pt'
    });

    // Validação de datas
    $('form').submit(function() {
      var data_inicio = $('#id_data_inicio').val();
      var data_fim = $('#id_data_fim').val();

      if (data_fim < data_inicio) {
        toastr["error"]("A data de fim não pode ser inferior à data de início!", "Validação")
        return false;
      } else {
        return true;
      }
    });
  </script>
{% endblock scripts %}
